import{j as A}from"./jsx-runtime.391947bd.js";import{r as i}from"./index.ed373d49.js";function P({src:a,width:x,height:r}){return new Promise(function(e,h){const t=new Image;t.crossOrigin="Anonymous",t.onload=function(){e(t)},t.onerror=function(){h(t)},t.src=a})}function X(a){return a.getContext("2d")}function Y({width:a,height:x,context:r,imgData:e,resolution:h,size:t,alpha:p,offset:w}){const s=a,l=x,g=r,u=h||16,d=t||u,R=p||1,c=w||0,f=s/u+1,o=l/u+1,n=d/2,C=c&&c.x||0,H=c&&c.y||0;let v,I,y,b,E,M,m,S,j,z,$;for(v=0;v<o;v++)for(b=(v-.5)*u+H,E=Math.max(Math.min(b,l-1),0),I=0;I<f;I++)y=(I-.5)*u+C,M=Math.max(Math.min(y,s-1),0),m=(M+E*s)*4,S=e[m],j=e[m+1],z=e[m+2],$=R*(e[m+3]/255),g.fillStyle="rgba("+S+","+j+","+z+","+$+")",g.fillRect(y-n,b-n,d,d)}function O(a){const{src:x,width:r,height:e,style:h}=a,t=i.useRef(),[p,w]=i.useState(8),s=i.useRef(),l=i.useRef(),[g,u]=i.useState(!1),[d,R]=i.useState(50);return i.useEffect(()=>{if(!t.current)return;async function c(){t.current&&(s.current||(s.current=X(t.current)))}c().then(f=>()=>{})},[t.current]),i.useEffect(()=>{async function c(){let f;if(!s.current)return;const o=s.current,n=await P({src:x,width:r,height:e});s.current.drawImage(n,0,0,n.width,n.height,0,0,r,e),l&&(l.current||(l.current=o.getImageData(0,0,r,e).data),f=l.current,p!==0&&(o.clearRect(0,0,r,e),Y({width:r,height:e,context:o,imgData:f,resolution:p})))}c().then(f=>()=>{})},[s,p]),i.useEffect(()=>{if(g){let o=setInterval(()=>{w(n=>n<=0?(clearInterval(o),0):n-2)},d);return()=>clearInterval(o)}else{let o=setInterval(()=>{w(n=>n>=20?(clearInterval(o),20):n+2)},d);return()=>clearInterval(o)}},[g]),A.jsx("div",{style:{width:`${r}px`,height:`${e}px`,position:"relative",overflow:"hidden",borderRadius:`${r}px`,...h},children:A.jsx("canvas",{style:{position:"absolute",inset:0},ref:t,width:r,height:e,onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)}})})}export{O as default};
